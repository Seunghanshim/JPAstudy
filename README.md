# JPA study
JPA study


# 요구사항 분석
 - 회원은 상품을 주문할 수 있다.
 
 - 주문 시 여러 종류의 상품을 선택할 수 있다.
 
 
# 기능 목록
  ## 회원 기능
   - 회원등록
   - 회원조회
  ## 상품 기능
   - 상품등록
   - 상품수정
   - 상품조회
  ## 주문 기능
   - 상품주문
   - 주문내역조회
   - 주문취소
   
   
# 도메인 모델 분석
  - 회원과 주문의 관계: 회원은 여러 번 주문할 수 있다. (1:N)
  - 주문과 상품의 관계: 주문할 때, 여러 상품을 선택할 수 있다. 
  반대로 같은 상품도 여러번 주문될 수 있다. 
  주문상품이라는 모델을 만들어서 N:N 관계를 1:N, N:1 관계로 풀어냈다.
  - 배송, 카테고리를 추가하였다.
  
      ![모델](https://user-images.githubusercontent.com/68942616/89035402-d49e4d00-d375-11ea-85fa-712cd4f7afd0.png)
  
  
# 테이블 설계
   ![테이블](https://user-images.githubusercontent.com/68942616/89035398-d36d2000-d375-11ea-8820-f10fa7fdd989.PNG)
      
      
# 객체 구조
  - 참조를 사용하도록 변경하였다.
  - 카테고리와 상품의 관계를 Category_ITEM이라는 모델을 만들어서 1:N, N:1 관계로 풀어냈다.
  
   ![엔티티](https://user-images.githubusercontent.com/68942616/89035394-d1a35c80-d375-11ea-96fd-84b3b8ffb02f.PNG)


# 연관관계 매핑 포인트
  - 객체와 테이블간에 연관관계를 맺는 차이를 이해해야 한다.
  - 객체의 양방향 관계는 양방향 관계가 아니라 서로 다른 단방향 관계 2개이다.
  - 양방향 매핑 시, 테이블에서 외래 키가 있는 곳을 주인으로 정한다. (주인이 아닌쪽은 읽기만 가능)
  - 단방향 매핑만으로도 이미 연관관계 매핑은 완료된 것이다. (양방향은 필요할 때 추가)
  - 양방향 매핑 시, 순수 객체 상태를 고려하여 항상 양쪽에 값을 설정한다. (연관관계 편의 메소드 생성)
      
      
# N:M 관계는 1:N, N:1로
  - 테이블의 N:M 관계는 중간테이블을 이용해서 1:N, N:1관계로 풀어낸다.
  - 실전에서 N:M 관계를 지양해야하는 이유는 중간 테이블이 단순하지 않기 때문이다.
  - 따라서 실전에서는 @ManyToMany를 사용하지 않는다.
